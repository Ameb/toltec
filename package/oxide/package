# vim: set ft=sh:
pkgname=oxide
pkgdesc="Launcher application"
url=https://github.com/Eeems/oxide
pkgver=1.3.2~beta-4
timestamp=2020-09-10T03:41Z
section=launchers
maintainer="raisjn <of.rajsn@gmail.com>"
license=MIT

image=qt
origin=https://github.com/Eeems/oxide.git
revision=17ecf0eaf9564ac5fe8745dc7f6de0f98e7f6f1e

build-app() {
    pushd applications/"$1"
    projectfile="${2-$1}".pro
    sed -i 's/linux-oe-g++/linux-arm-gnueabihf-g++/' "$projectfile"
    qmake "$projectfile"
    make
    popd
}

build() {
    build-app launcher oxide
    build-app system-service tarnish
    build-app process-manager erode
    build-app settings-manager rot
}

package() {
    install -D -m 755 -t "$pkgdir"/opt/bin \
        "$srcdir"/applications/launcher/oxide \
        "$srcdir"/applications/system-service/tarnish \
        "$srcdir"/applications/process-manager/erode \
        "$srcdir"/applications/settings-manager/rot

    install -D -m 644 -t "$pkgdir"/opt/etc "$srcdir"/assets/etc/oxide.conf
    install -D -m 644 "$srcdir"/assets/etc/draft/01-xochitl "$pkgdir"/opt/etc/draft/xochitl
    install -D -m 644 -t "$pkgdir"/opt/etc/draft/icons "$srcdir"/assets/etc/draft/icons/xochitl.png
    install -D -m 644 -t "$pkgdir"/etc/systemd/system "$srcdir"/assets/etc/systemd/system/oxide.service
}
